<template>
	<div class="flex">
		<div class="flex flex-col">
			<div class="flex">
				<ActionSegmentResource :resource="CardResource.HEALING" :quantity="player.health" />
				<div class="flex flex-col">
					<ActionSegmentResource :resource="CardResource.ECONOMY" :quantity="turn.economy" />
					<ActionSegmentResource :resource="CardResource.DAMAGE" :quantity="turn.damage" />
					<ActionSegmentResource :resource="CardResource.HEALING" :quantity="turn.healing" />
				</div>
				<CardVue v-for="(card, index) in playedCards" :key="index" :card="card" class="card-small" />
			</div>
			<div class="flex">
				<CardVue v-for="(card, index) in handCards" :key="index" :card="card" :player="player" />
			</div>
		</div>
		<div class="flex flex-col">
			<div class="card-stack card-small card-vertical">
				<div>{{ deckCards.length }}</div>
				<div>Deck</div>
			</div>
			<div class="card-stack card-small card-horizontal">
				<div>{{ discardCards.length }}</div>
				<div>Discard</div>
			</div>
			<button v-if="handCards.length" class="card-stack card-small card-horizontal !bg-white border-[3px] border-gray-200 text-lg font-bold" @click="onPlayAll">
				Play all
			</button>
			<button v-else class="card-stack card-small card-horizontal !bg-white border-[3px] border-gray-200 text-lg font-bold" @click="onEndTurn">
				End turn
			</button>
		</div>
	</div>
</template>

<script setup lang="ts">
import CardVue from '#p/views/components/Game/Card/Card.vue'
import ActionSegmentResource from '#p/views/components/Game/Card/ActionSegmentResource.vue'

import { defineProps, reactive } from 'vue'

import type { PlayPlayer } from '#c/game/Play'
import { CardResource } from '#c/types/cards'

const props = defineProps<{
	player: PlayPlayer
}>()

const deckCards = reactive(props.player.deck)
const handCards = reactive(props.player.hand)
const playedCards = reactive(props.player.played)
const discardCards = reactive(props.player.discard)
const turn = reactive(props.player.turn)

function onPlayAll() {
	handCards.forEach(card => props.player.play(card)) //TODO
}

function onEndTurn() {
	console.log('End turn')
}
</script>
